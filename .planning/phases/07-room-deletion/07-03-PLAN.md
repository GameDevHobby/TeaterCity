---
phase: 07-room-deletion
plan: 03
type: execute
wave: 3
depends_on: ["07-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can delete a room via menu"
    - "Confirmation dialog prevents accidental deletion"
    - "Deleted room visuals are removed from tilemap"
    - "Adjacent room walls remain intact after deletion"
    - "Patrons do not navigate to deleted room"
    - "Deleted room persists (stays deleted after restart)"
  artifacts: []
  key_links: []
---

<objective>
Verify room deletion works correctly through human testing.

Purpose: Validate the full deletion flow including edge cases like adjacent rooms and navigation. Automated tests cannot verify visual outcomes or patron behavior.

Output: Confirmed working room deletion feature ready for milestone.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-room-deletion/07-RESEARCH.md
@.planning/phases/07-room-deletion/07-01-SUMMARY.md
@.planning/phases/07-room-deletion/07-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Verify room deletion workflow</name>
  <what-built>
Room deletion feature with:
- Delete Room button in room edit menu
- ConfirmationDialog for safety
- Visual cleanup (walls, doors, furniture)
- Shared wall preservation for adjacent rooms
- Navigation update and patron rerouting
- Auto-save integration
  </what-built>
  <how-to-verify>
**Setup (if needed):**
1. Run the game: `godot --path .`
2. If no rooms exist, create 2-3 test rooms:
   - One standalone room
   - Two adjacent rooms (sharing a wall boundary)
   - Add furniture to at least one room

**Test 1: Basic Deletion**
1. Tap on a standalone room to select it
2. Verify room edit menu appears with "Delete Room" button
3. Tap "Delete Room"
4. Verify confirmation dialog appears with warning text
5. Tap "Cancel" - verify room is NOT deleted, menu still visible
6. Tap "Delete Room" again, then "OK" on dialog
7. Verify:
   - Room walls disappear from tilemap
   - Room furniture disappears
   - Room can no longer be selected (Area2D removed)
   - Menu closes automatically

**Test 2: Adjacent Room Preservation**
1. Create two rooms that share a wall boundary (build them side by side)
2. Delete ONE of the rooms
3. Verify:
   - Deleted room's walls are removed
   - Adjacent room's shared wall remains intact (no holes)
   - Adjacent room can still be selected and edited

**Test 3: Navigation Update**
1. If patrons exist, observe their behavior after deletion
2. Patrons should:
   - NOT walk into the deleted room area
   - Recalculate paths if their target was in the deleted room
3. No console errors about navigation or null references

**Test 4: Persistence**
1. Delete a room
2. Close the game completely
3. Reopen the game
4. Verify:
   - Deleted room does NOT reappear
   - Other rooms are still present
   - Check console for successful load message

**Expected Results:**
- All tests pass without errors
- Deletion is clean (no ghost visuals or phantom selections)
- Adjacent rooms unaffected
- Changes persist across restarts
  </how-to-verify>
  <resume-signal>
Type "approved" if all tests pass.
If issues found, describe:
- Which test failed
- What happened vs expected
- Any console errors
  </resume-signal>
</task>

</tasks>

<verification>
Human verification checkpoint - no automated verification for this plan.
</verification>

<success_criteria>
- Delete Room button visible and functional
- Confirmation dialog prevents accidental deletion
- Deleted room visuals fully removed
- Adjacent room walls preserved (no holes)
- Navigation updates correctly (patrons reroute)
- Deletion persists after game restart
- No console errors during deletion
</success_criteria>

<output>
After completion, create `.planning/phases/07-room-deletion/07-03-SUMMARY.md`
</output>
